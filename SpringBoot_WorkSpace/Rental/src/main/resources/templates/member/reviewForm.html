<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <title>리뷰 작성</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
    <style>
      .dropzone {
        background: #fafbfc;
        border-radius: 18px;
        border: 2px solid #eee;
        min-height: 260px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: #888;
        font-size: 1.08rem;
        margin-bottom: 18px;
        cursor: pointer;
        position: relative;
        transition: border-color 0.2s;
      }

      .dropzone.dragover {
        border-color: #ff6f0f;
        background: #fff7f0;
      }

      .dropzone .icon {
        font-size: 2.5rem;
        color: #bbb;
        margin-bottom: 12px;
      }

      .dropzone .dz-btn {
        background: #ff6f0f;
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 8px 20px;
        font-weight: bold;
        margin-top: 16px;
        font-size: 1.05rem;
      }

      input:focus,
      textarea:focus {
        outline: none !important;
        box-shadow: none !important;
        border-color: #ff6f0f !important;
      }

      /* .review-container 스타일 제거 */
      .review-title {
        font-size: 1.5rem;
        font-weight: bold;
        color: #222;
        margin-bottom: 24px;
      }

      .review-label {
        font-weight: 500;
        margin-bottom: 6px;
      }

      .review-btn {
        background: #ff6f0f;
        color: #fff;
        font-weight: bold;
        border-radius: 8px;
        font-size: 1.08rem;
        margin-top: 32px;
      }
    </style>
  </head>

  <body>
    <div
      class="d-flex justify-content-between align-items-center px-5 pt-4"
      style="background: #fff"
    >
      <div class="d-flex align-items-center">
        <div class="d-flex flex-column align-items-start">
          <a
            href="/"
            class="fw-bold"
            style="
              font-size: 2rem;
              color: #ff6f0f;
              line-height: 1.1;
              text-decoration: none !important;
            "
            >PROJECT</a
          >
          <span
            class="ms-1"
            style="
              font-size: 0.95rem;
              color: #444;
              font-weight: 500;
              line-height: 1.1;
              margin-top: 2px;
              margin-bottom: 0;
            "
            >공간 대여 플랫폼</span
          >
        </div>
      </div>
      <!-- 리뷰 등록 버튼 상단바 오른쪽 끝 -->
      <button
        type="submit"
        form="reviewForm"
        class="btn review-btn"
        style="height: 44px; font-size: 1.08rem; min-width: 120px"
      >
        리뷰 등록
      </button>
    </div>

    <!-- 컨테이너 스타일 제거, 폼만 심플하게 출력 -->
    <div class="review-title" style="text-align: center; margin-top: 50px">
      리뷰 작성
    </div>
    <div
      style="
        width: 100vw;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: flex-start;
      "
    >
      <form
        id="reviewForm"
        th:action="@{/member/reviewWrite(placeId=${requestAccept.place.id})}"
        method="post"
        th:object="${replyForm}"
        enctype="multipart/form-data"
        style="max-width: 1500px; width: 100%; margin-top: 32px"
      >
        <div
          style="
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: flex-start;
            gap: 48px;
            max-width: 1500px;
            margin: 0 auto;
          "
        >
          <!-- 왼쪽: 사진첨부 -->
          <div
            style="
              flex: 1;
              display: flex;
              flex-direction: column;
              align-items: center;
              min-width: 700px;
              max-width: 700px;
            "
          >
            <div
              class="review-label"
              style="width: 100%; text-align: left; margin-bottom: 8px"
            >
              이미지 첨부
            </div>
            <div
              class="dropzone"
              id="dropzone"
              style="
                width: 100%;
                max-width: 700px;
                min-width: 700px;
                min-height: 600px;
              "
            >
              <span class="icon"><i class="bi bi-camera"></i></span>
              <div>사진을 끌어다 놓으세요</div>

              <button
                type="button"
                class="dz-btn"
                onclick="document.getElementById('rfiles').click()"
              >
                PC에서 불러오기
              </button>
              <input
                type="file"
                id="rfiles"
                th:field="*{rfiles}"
                multiple
                style="display: none"
              />
              <div
                id="file-list"
                style="margin-top: 10px; font-size: 0.97rem"
              ></div>
            </div>
          </div>
          <!-- 오른쪽: 리뷰영역 -->
          <div
            style="
              flex: 1;
              display: flex;
              flex-direction: column;
              min-width: 700px;
              max-width: 700px;
              padding-left: 0;
              height: 100%;
            "
          >
            <!-- 상단 고정 영역 -->
            <div style="width: 100%">
              <div
                class="review-label"
                style="width: 100%; text-align: left; margin-bottom: 8px"
              >
                예약일
              </div>
              <input
                type="text"
                class="form-control"
                th:value="${requestAccept.bdate}"
                readonly
                style="
                  background: #eee;
                  border-radius: 16px;
                  font-size: 1.08rem;
                  height: 48px;
                  margin-bottom: 16px;
                "
              />
              <label class="review-label" style="margin-top: 12px">장소</label>
              <input
                type="text"
                class="form-control"
                th:value="${requestAccept.place.ptitle}"
                readonly
                style="
                  background: #eee;
                  border-radius: 16px;
                  font-size: 1.08rem;
                  height: 48px;
                  margin-bottom: 16px;
                "
              />
            </div>
            <!-- 아래로 내린 입력 영역 -->
            <div
              style="
                flex: 1;
                display: flex;
                flex-direction: column;
                justify-content: flex-end;
                height: 100%;
                margin-top: 64px;
              "
            >
              <label for="rcontent" class="review-label">리뷰 내용</label>
              <textarea
                class="form-control"
                id="rcontent"
                th:field="*{rcontent}"
                style="
                  border-radius: 16px;
                  font-size: 1.08rem;
                  width: 100%;
                  height: 335px;
                  resize: none;
                  margin-bottom: 32px;
                "
              ></textarea>
              <!-- 기존 폼 하단의 리뷰 등록 버튼 제거 -->
            </div>
          </div>
        </div>
		
        <script>
          const dropzone = document.getElementById("dropzone");
          const fileInput = document.getElementById("rfiles");
          const fileList = document.getElementById("file-list");
          dropzone.addEventListener("click", function (e) {
            if (e.target.classList.contains("dz-btn")) return;
            fileInput.click();
          });
          dropzone.addEventListener("dragover", function (e) {
            e.preventDefault();
            dropzone.classList.add("dragover");
          });
          dropzone.addEventListener("dragleave", function (e) {
            dropzone.classList.remove("dragover");
          });
          dropzone.addEventListener("drop", function (e) {
            e.preventDefault();
            dropzone.classList.remove("dragover");
            fileInput.files = e.dataTransfer.files;
            updateFileList();
          });
          fileInput.addEventListener("change", updateFileList);
          function updateFileList() {
            fileList.innerHTML = "";
            if (fileInput.files.length > 0) {
              for (let i = 0; i < fileInput.files.length; i++) {
                const f = fileInput.files[i];
                fileList.innerHTML += `<span style='color:#2196f3'>${f.name}</span> `;
              }
            }
          }
        </script>
      </form>
    </div>
  </body>
</html>